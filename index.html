<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Logistics Enterprise System</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    
    <style>
        /* --- THEME: INDUSTRIAL CLARITY --- */
        :root {
            --navy: #001F3F;
            --blue-light: #3a506b;
            --light-grey: #F4F4F4;
            --green: #2ECC40;
            --amber: #FFDC00;
            --red: #FF4136;
            --white: #ffffff;
            --border: #e0e0e0;
        }

        body { margin: 0; font-family: 'Segoe UI', Roboto, Helvetica, Arial, sans-serif; background-color: var(--light-grey); color: #333; }
        .hidden { display: none !important; }

        /* --- UI COMPONENTS --- */
        .btn { background-color: var(--navy); color: white; padding: 8px 12px; border: none; border-radius: 4px; cursor: pointer; font-size: 13px; display: inline-flex; align-items: center; gap: 6px; transition: 0.2s;}
        .btn:hover { opacity: 0.9; }
        .btn.outline { background: transparent; border: 1px solid var(--navy); color: var(--navy); }
        .btn.small { padding: 4px 8px; font-size: 11px; }
        
        .badge { padding: 4px 8px; border-radius: 4px; font-size: 10px; font-weight: bold; color: white; text-transform: uppercase; letter-spacing: 0.5px;}
        .badge.green { background-color: var(--green); }
        .badge.amber { background-color: var(--amber); color: black; }
        .badge.red { background-color: var(--red); }
        .badge.blue { background-color: var(--blue-light); }

        /* --- LAYOUT --- */
        #login-screen { height: 100vh; display: flex; justify-content: center; align-items: center; background-color: var(--navy); }
        .login-card { background: white; padding: 40px; border-radius: 8px; width: 350px; text-align: center; box-shadow: 0 10px 25px rgba(0,0,0,0.3); }
        .login-card input { width: 100%; padding: 12px; margin: 10px 0; border: 1px solid #ccc; border-radius: 4px; box-sizing: border-box; }

        #dashboard-screen { display: flex; height: 100vh; }
        
        .sidebar { width: 260px; background-color: white; border-right: 1px solid #ddd; display: flex; flex-direction: column; flex-shrink: 0;}
        .sidebar-header { padding: 25px 20px; background-color: var(--navy); color: white; font-weight: bold; display: flex; align-items: center; gap: 10px;}
        .menu-item { padding: 15px 20px; cursor: pointer; color: #555; display: flex; align-items: center; border-left: 5px solid transparent; transition: all 0.2s; }
        .menu-item i { margin-right: 15px; width: 20px; text-align: center; }
        .menu-item:hover { background-color: #f8f9fa; color: var(--navy); }
        .menu-item.active { background-color: #e9ecef; color: var(--navy); border-left-color: var(--navy); font-weight: bold; }

        .main-content { flex: 1; padding: 20px; overflow-y: hidden; display: flex; flex-direction: column;} 
        .header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; flex-shrink: 0;}

        /* --- DISPATCHER & MAP SPLIT VIEW --- */
        .split-view { display: flex; gap: 20px; height: 100%; overflow: hidden; }
        .fleet-list { flex: 1; background: white; border-radius: 8px; overflow-y: auto; box-shadow: 0 2px 5px rgba(0,0,0,0.05); display: flex; flex-direction: column;}
        .map-panel { flex: 2; border-radius: 8px; overflow: hidden; border: 2px solid #ccc; position: relative; }
        #map-container { height: 100%; width: 100%; }

        /* Fleet List Items */
        .fleet-item { padding: 15px; border-bottom: 1px solid #eee; display: flex; align-items: center; gap: 15px; cursor: pointer; transition: background 0.2s; }
        .fleet-item:hover { background-color: #f0f4f8; }
        .fleet-item.selected { background-color: #e3f2fd; border-left: 4px solid var(--navy); }
        .driver-avatar { width: 50px; height: 50px; border-radius: 50%; object-fit: cover; border: 2px solid #ddd; }
        .fleet-details { flex: 1; }
        .fleet-plate { font-weight: bold; font-size: 14px; color: var(--navy); }
        .fleet-sub { font-size: 11px; color: #777; margin-top: 3px; display: flex; gap: 10px;}
        .fleet-actions { display: flex; gap: 5px; }

        /* --- HR MODULE (201 FILES) --- */
        .file-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(240px, 1fr)); gap: 20px; padding-bottom: 20px;}
        .file-card { background: white; border-top: 4px solid var(--navy); border-radius: 8px; padding: 20px; box-shadow: 0 2px 5px rgba(0,0,0,0.05); transition: transform 0.2s; }
        .file-card:hover { transform: translateY(-2px); box-shadow: 0 5px 15px rgba(0,0,0,0.1); }
        .emp-photo { width: 80px; height: 80px; border-radius: 50%; border: 3px solid #eee; object-fit: cover; margin-bottom: 10px; }
        
        /* --- CALENDAR --- */
        .calendar-grid { display: grid; grid-template-columns: repeat(7, 1fr); gap: 10px; height: 100%; overflow-y: auto;}
        .calendar-day { background: white; min-height: 100px; padding: 10px; border: 1px solid #eee; border-radius: 4px; }
        .day-label { font-weight: bold; color: #888; margin-bottom: 5px; display: block;}
        .event-pill { font-size: 10px; padding: 3px 6px; margin-top: 4px; border-radius: 3px; color: white; cursor: pointer; display: flex; align-items: center; gap: 5px;}

        /* --- MODALS --- */
        .modal-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); z-index: 2000; display: flex; justify-content: center; align-items: center; }
        .modal-content { background: white; width: 600px; max-height: 90vh; border-radius: 8px; overflow: hidden; animation: slideDown 0.2s; display: flex; flex-direction: column;}
        .modal-header { background: var(--navy); color: white; padding: 15px; display: flex; justify-content: space-between; align-items: center; }
        .modal-body { padding: 20px; overflow-y: auto; }
        
        .modal-tabs { display: flex; border-bottom: 1px solid #ddd; padding: 0 20px; background: #f9f9f9; }
        .modal-tab { padding: 15px 20px; cursor: pointer; color: #666; border-bottom: 3px solid transparent; font-size: 13px; font-weight: 500; }
        .modal-tab.active { color: var(--navy); border-bottom-color: var(--navy); background: white; }

        .form-group { margin-bottom: 15px; }
        .form-group label { display: block; font-size: 11px; color: #666; font-weight: bold; margin-bottom: 5px; text-transform: uppercase; }
        .form-group input, .form-group select { width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 4px; box-sizing: border-box; }
        .info-display { background: #f4f4f4; padding: 10px; border-radius: 4px; border: 1px solid #eee; font-size: 14px; }
        
        .form-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; }

        @keyframes slideDown { from {transform: translateY(-20px); opacity: 0;} to {transform: translateY(0); opacity: 1;} }
    </style>
</head>
<body>

    <div id="login-screen">
        <div class="login-card">
            <i class="fa-solid fa-earth-americas fa-3x" style="color: var(--navy); margin-bottom: 20px;"></i>
            <h2 style="color: var(--navy); margin-top: 0;">LOGISTICS ENTERPRISE</h2>
            <p style="color: #666; font-size: 14px;">Combined Operations System V8.0</p>
            <input type="text" placeholder="User ID" value="ADMIN-01">
            <input type="password" placeholder="Password" value="password">
            <button class="btn" style="width: 100%; justify-content: center; padding: 12px;" onclick="login()">SECURE LOGIN</button>
        </div>
    </div>

    <div id="dashboard-screen" class="hidden">
        
        <div class="sidebar">
            <div class="sidebar-header"><i class="fa-solid fa-layer-group"></i> COMMAND CENTER</div>
            <div class="menu-item active" onclick="showView('dispatch-module', this)"><i class="fa-solid fa-map-location-dot"></i> Fleet Command</div>
            <div class="menu-item" onclick="showView('hr-module', this)"><i class="fa-solid fa-users"></i> HR (201 Files)</div>
            <div class="menu-item" onclick="showView('schedule-module', this)"><i class="fa-solid fa-calendar-days"></i> Master Schedule</div>
            <div class="menu-item" onclick="showView('inventory-module', this)"><i class="fa-solid fa-boxes-stacked"></i> Inventory</div>
            <div style="margin-top: auto;"></div>
            <div class="menu-item" onclick="logout()"><i class="fa-solid fa-right-from-bracket"></i> Logout</div>
        </div>

        <div class="main-content">
            
            <div id="dispatch-module" class="view-section" style="height: 100%; display: flex; flex-direction: column;">
                <div class="header">
                    <h1 style="color: var(--navy); margin: 0;">Fleet Command</h1>
                    <div style="display: flex; gap: 15px;">
                        <div style="background: white; padding: 5px 15px; border-radius: 4px; border-left: 3px solid var(--blue-light); box-shadow: 0 2px 5px rgba(0,0,0,0.05);">
                            <span style="font-size: 10px; color: #888;">ON ROUTE</span><br><b>2 Vehicles</b>
                        </div>
                        <div style="background: white; padding: 5px 15px; border-radius: 4px; border-left: 3px solid var(--amber); box-shadow: 0 2px 5px rgba(0,0,0,0.05);">
                            <span style="font-size: 10px; color: #888;">MAINTENANCE</span><br><b>1 Vehicle</b>
                        </div>
                    </div>
                </div>

                <div class="split-view">
                    <div class="fleet-list">
                        <div style="padding: 15px; border-bottom: 1px solid #eee; background: #fafafa;">
                            <b style="color: var(--navy);">Active Fleet Roster</b>
                        </div>
                        <div id="fleet-list-container">
                            </div>
                    </div>
                    <div class="map-panel">
                        <div id="map-container"></div>
                        <div style="position: absolute; bottom: 10px; left: 10px; background: rgba(255,255,255,0.9); padding: 10px; border-radius: 4px; font-size: 11px; z-index: 999; border: 1px solid #ccc;">
                            <i class="fa-solid fa-circle" style="color: var(--blue-light);"></i> Active Route Path<br>
                            <i class="fa-solid fa-location-dot" style="color: var(--navy);"></i> Vehicle Position<br>
                            <i class="fa-solid fa-flag-checkered" style="color: black;"></i> Destination
                        </div>
                    </div>
                </div>
            </div>

            <div id="hr-module" class="view-section hidden" style="height: 100%; overflow-y: auto;">
                <div class="header">
                    <h1 style="color: var(--navy); margin: 0;">Employee Database (201 Files)</h1>
                    <button class="btn"><i class="fa-solid fa-user-plus"></i> New Hire</button>
                </div>
                <div class="file-grid">
                    <div class="file-card">
                        <div style="text-align: center;">
                            <img src="https://i.pravatar.cc/150?img=11" class="emp-photo">
                            <h3 style="margin:0; color:var(--navy);">John Doe</h3>
                            <p style="margin:0; color:#777; font-size:12px;">Senior Driver</p>
                            <div style="margin: 10px 0;"><span class="badge green">ACTIVE</span></div>
                            <button class="btn outline small" style="width:100%; justify-content:center;" onclick="open201Modal('John Doe', 'Senior Driver', 'https://i.pravatar.cc/150?img=11')">
                                <i class="fa-regular fa-folder-open"></i> View 201 File
                            </button>
                        </div>
                    </div>
                    <div class="file-card">
                        <div style="text-align: center;">
                            <img src="https://i.pravatar.cc/150?img=3" class="emp-photo">
                            <h3 style="margin:0; color:var(--navy);">Mike Santos</h3>
                            <p style="margin:0; color:#777; font-size:12px;">Forklift Operator</p>
                            <div style="margin: 10px 0;"><span class="badge red">SICK LEAVE</span></div>
                            <button class="btn outline small" style="width:100%; justify-content:center;" onclick="open201Modal('Mike Santos', 'Forklift Operator', 'https://i.pravatar.cc/150?img=3')">
                                <i class="fa-regular fa-folder-open"></i> View 201 File
                            </button>
                        </div>
                    </div>
                     <div class="file-card">
                        <div style="text-align: center;">
                            <img src="https://i.pravatar.cc/150?img=5" class="emp-photo">
                            <h3 style="margin:0; color:var(--navy);">Sarah Lee</h3>
                            <p style="margin:0; color:#777; font-size:12px;">Dispatcher</p>
                            <div style="margin: 10px 0;"><span class="badge green">ACTIVE</span></div>
                            <button class="btn outline small" style="width:100%; justify-content:center;" onclick="open201Modal('Sarah Lee', 'Dispatcher', 'https://i.pravatar.cc/150?img=5')">
                                <i class="fa-regular fa-folder-open"></i> View 201 File
                            </button>
                        </div>
                    </div>
                     <div class="file-card">
                        <div style="text-align: center;">
                            <img src="https://i.pravatar.cc/150?img=13" class="emp-photo">
                            <h3 style="margin:0; color:var(--navy);">Rico Jose</h3>
                            <p style="margin:0; color:#777; font-size:12px;">Junior Driver</p>
                            <div style="margin: 10px 0;"><span class="badge amber">ON BREAK</span></div>
                            <button class="btn outline small" style="width:100%; justify-content:center;" onclick="open201Modal('Rico Jose', 'Junior Driver', 'https://i.pravatar.cc/150?img=13')">
                                <i class="fa-regular fa-folder-open"></i> View 201 File
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <div id="schedule-module" class="view-section hidden" style="height: 100%; display: flex; flex-direction: column;">
                <div class="header"><h1>Master Schedule</h1></div>
                <div class="calendar-grid">
                    <div class="calendar-day"><span class="day-label">Monday</span><div class="event-pill" style="background:var(--navy)">Route 101</div><div class="event-pill" style="background:var(--navy)">Route 102</div></div>
                    <div class="calendar-day"><span class="day-label">Tuesday</span><div class="event-pill" style="background:var(--red)"><i class="fa-solid fa-user-xmark"></i> Sick: Mike</div></div>
                    <div class="calendar-day"><span class="day-label">Wednesday</span></div>
                    <div class="calendar-day"><span class="day-label">Thursday</span><div class="event-pill" style="background:var(--navy)">Route 105</div></div>
                    <div class="calendar-day"><span class="day-label">Friday</span><div class="event-pill" style="background:var(--amber)"><i class="fa-solid fa-wrench"></i> Truck 04 Maint</div></div>
                    <div class="calendar-day"><span class="day-label">Saturday</span></div>
                    <div class="calendar-day"><span class="day-label">Sunday</span></div>
                </div>
            </div>

            <div id="inventory-module" class="view-section hidden">
                <div class="header"><h1>Inventory System</h1></div>
                <table style="width:100%; border-collapse:collapse; background:white; border-radius:8px; overflow:hidden;">
                    <tr style="background:var(--navy); color:white; text-align:left;"><th style="padding:15px;">SKU</th><th style="padding:15px;">Item</th><th style="padding:15px;">Qty</th><th style="padding:15px;">Status</th></tr>
                    <tr><td style="padding:15px; border-bottom:1px solid #eee;">#991</td><td style="padding:15px; border-bottom:1px solid #eee;">Hydraulic Pump</td><td style="padding:15px; border-bottom:1px solid #eee;">12</td><td style="padding:15px; border-bottom:1px solid #eee;"><span class="badge green">OK</span></td></tr>
                    <tr><td style="padding:15px; border-bottom:1px solid #eee;">#552</td><td style="padding:15px; border-bottom:1px solid #eee;">Tires (Forklift)</td><td style="padding:15px; border-bottom:1px solid #eee;">2</td><td style="padding:15px; border-bottom:1px solid #eee;"><span class="badge red">LOW</span></td></tr>
                </table>
            </div>

        </div>
    </div>

    <div id="vehicle-modal" class="modal-overlay hidden">
        <div class="modal-content">
            <div class="modal-header">
                <span><i class="fa-solid fa-truck-front"></i> Edit Vehicle Profile</span>
                <button onclick="closeModal('vehicle-modal')" style="background:none; border:none; color:white; font-size:18px; cursor:pointer;">&times;</button>
            </div>
            <div class="modal-body">
                <input type="hidden" id="edit-vehicle-id">
                <div class="form-group">
                    <label>Assigned Driver</label>
                    <input type="text" id="edit-driver" readonly style="background:#eee;">
                </div>
                <div class="form-group">
                    <label>Current Status</label>
                    <select id="edit-status">
                        <option value="Available">Available</option>
                        <option value="On Route">On Route</option>
                        <option value="Maintenance">Maintenance</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Odometer (Mileage)</label>
                    <input type="number" id="edit-mileage">
                </div>
                <div style="display:flex; justify-content:flex-end; gap:10px; margin-top:20px;">
                    <button class="btn outline" onclick="closeModal('vehicle-modal')">Cancel</button>
                    <button class="btn" onclick="saveVehicleChanges()">Save Changes</button>
                </div>
            </div>
        </div>
    </div>

    <div id="file-modal" class="modal-overlay hidden">
        <div class="modal-content" style="width: 700px;">
            <div class="modal-header">
                <span><i class="fa-solid fa-folder-open"></i> Employee 201 File</span>
                <button onclick="closeModal('file-modal')" style="background:none; border:none; color:white; font-size:18px; cursor:pointer;">&times;</button>
            </div>
            <div class="modal-tabs">
                <div class="modal-tab active">Personal Info</div>
                <div class="modal-tab">Employment History</div>
                <div class="modal-tab">Govt IDs</div>
            </div>
            <div class="modal-body">
                <div style="display: flex; gap: 20px;">
                    <div style="width: 120px; text-align: center;">
                        <img id="modal-img" src="" style="width: 100px; height: 100px; border-radius: 8px; border: 1px solid #ddd; object-fit: cover;">
                        <div style="margin-top: 10px; font-weight: bold; color: var(--navy);" id="modal-name-display"></div>
                    </div>
                    <div style="flex: 1;">
                        <div class="form-grid">
                            <div class="form-group">
                                <label>Full Name</label>
                                <div class="info-display" id="modal-name"></div>
                            </div>
                            <div class="form-group">
                                <label>Position</label>
                                <div class="info-display" id="modal-role"></div>
                            </div>
                            <div class="form-group">
                                <label>SSS Number</label>
                                <div class="info-display">33-9876543-1</div>
                            </div>
                            <div class="form-group">
                                <label>PhilHealth</label>
                                <div class="info-display">12-123456789-1</div>
                            </div>
                            <div class="form-group" style="grid-column: span 2;">
                                <label style="color: var(--red);">Emergency Contact</label>
                                <div class="info-display"><b>Maria Doe (Spouse)</b> - 0917-000-0000</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>

    <script>
        // --- DATA ---
        const fleetData = [
            { id: 1, driver: "John Doe", img: "https://i.pravatar.cc/150?img=11", plate: "NCA-1234", type: "Isuzu Giga", status: "On Route", mileage: 45200, currentPos: [14.6507, 121.0285], startPos: [14.6760, 121.0437], endPos: [14.6091, 120.9814] },
            { id: 2, driver: "Rico Jose", img: "https://i.pravatar.cc/150?img=13", plate: "XLM-992", type: "L300 Van", status: "Available", mileage: 12500, currentPos: [14.6415, 121.0423], startPos: null, endPos: null },
            { id: 3, driver: "Mike Santos", img: "https://i.pravatar.cc/150?img=3", plate: "RTY-551", type: "Wing Van", status: "Maintenance", mileage: 89000, currentPos: [14.6178, 121.0572], startPos: null, endPos: null },
            { id: 4, driver: "Alex Lim", img: "https://i.pravatar.cc/150?img=68", plate: "ABC-111", type: "Canter", status: "On Route", mileage: 33100, currentPos: [14.5844, 121.0609], startPos: [14.6178, 121.0572], endPos: [14.5547, 121.0244] }
        ];

        let map, markers = {}, routeLine = null;

        // --- MAP FUNCTIONS ---
        function initMap() {
            if (map) return;
            map = L.map('map-container').setView([14.6450, 121.0350], 13);
            L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png').addTo(map);
            
            fleetData.forEach(v => {
                const marker = L.marker(v.currentPos).addTo(map);
                marker.bindPopup(`<b>${v.plate}</b><br>${v.driver}`);
                markers[v.id] = marker;
            });
        }

        function focusVehicle(id) {
            const vehicle = fleetData.find(v => v.id === id);
            if(!vehicle) return;

            document.querySelectorAll('.fleet-item').forEach(el => el.classList.remove('selected'));
            
            if(map) {
                if(routeLine) map.removeLayer(routeLine);
                map.setView(vehicle.currentPos, 14);
                markers[vehicle.id].openPopup();

                if(vehicle.status === 'On Route' && vehicle.startPos && vehicle.endPos) {
                    const latlngs = [vehicle.startPos, vehicle.currentPos, vehicle.endPos];
                    routeLine = L.polyline(latlngs, {color: '#3a506b', weight: 4, opacity: 0.7, dashArray: '10, 10'}).addTo(map);
                    L.marker(vehicle.startPos, {icon: createIcon('green')}).addTo(map);
                    L.marker(vehicle.endPos, {icon: createIcon('red')}).addTo(map);
                    map.fitBounds(routeLine.getBounds(), {padding: [50,50]});
                }
            }
        }

        function createIcon(color) {
            return L.divIcon({
                className: 'custom-icon',
                html: `<i class="fa-solid fa-flag" style="color:${color}; font-size:20px; text-shadow: 2px 2px 2px white;"></i>`,
                iconSize: [20, 20],
                iconAnchor: [10, 20]
            });
        }

        // --- RENDERERS ---
        function renderFleetList() {
            const container = document.getElementById('fleet-list-container');
            container.innerHTML = '';
            fleetData.forEach(vehicle => {
                let badgeColor = vehicle.status === 'On Route' ? 'blue' : (vehicle.status === 'Maintenance' ? 'amber' : 'green');
                const div = document.createElement('div');
                div.className = 'fleet-item';
                div.onclick = () => focusVehicle(vehicle.id);
                div.innerHTML = `
                    <img src="${vehicle.img}" class="driver-avatar">
                    <div class="fleet-details">
                        <div class="fleet-plate">${vehicle.plate} <span class="badge ${badgeColor}">${vehicle.status}</span></div>
                        <div class="fleet-sub"><span>${vehicle.driver}</span><span>${vehicle.mileage.toLocaleString()} km</span></div>
                    </div>
                    <div class="fleet-actions">
                        <button class="btn outline small" onclick="event.stopPropagation(); editProfile(${vehicle.id})">Edit</button>
                        ${vehicle.status === 'On Route' ? '<button class="btn small"><i class="fa-solid fa-crosshairs"></i></button>' : ''}
                    </div>
                `;
                container.appendChild(div);
            });
        }

        // --- MODALS ---
        function editProfile(id) {
            const vehicle = fleetData.find(v => v.id === id);
            document.getElementById('edit-vehicle-id').value = vehicle.id;
            document.getElementById('edit-driver').value = vehicle.driver;
            document.getElementById('edit-mileage').value = vehicle.mileage;
            document.getElementById('edit-status').value = vehicle.status;
            document.getElementById('vehicle-modal').classList.remove('hidden');
        }

        function saveVehicleChanges() {
            const id = parseInt(document.getElementById('edit-vehicle-id').value);
            const vehicle = fleetData.find(v => v.id === id);
            vehicle.mileage = parseInt(document.getElementById('edit-mileage').value);
            vehicle.status = document.getElementById('edit-status').value;
            closeModal('vehicle-modal');
            renderFleetList();
        }

        function open201Modal(name, role, imgSrc) {
            document.getElementById('modal-name').innerText = name;
            document.getElementById('modal-name-display').innerText = name;
            document.getElementById('modal-role').innerText = role;
            document.getElementById('modal-img').src = imgSrc;
            document.getElementById('file-modal').classList.remove('hidden');
        }

        function closeModal(id) {
            document.getElementById(id).classList.add('hidden');
        }

        // --- VIEW CONTROLLER ---
        function login() {
            document.getElementById('login-screen').style.display = 'none';
            document.getElementById('dashboard-screen').classList.remove('hidden');
            renderFleetList();
            setTimeout(() => { initMap(); map.invalidateSize(); }, 100);
        }

        function logout() {
            document.getElementById('dashboard-screen').classList.add('hidden');
            document.getElementById('login-screen').style.display = 'flex';
        }

        function showView(viewId, element) {
            document.querySelectorAll('.view-section').forEach(v => v.classList.add('hidden'));
            document.getElementById(viewId).classList.remove('hidden');
            document.querySelectorAll('.menu-item').forEach(item => item.classList.remove('active'));
            element.classList.add('active');
            if(viewId === 'dispatch-module') setTimeout(() => { if(map) map.invalidateSize(); }, 100);
        }
    </script>
</body>
</html>
